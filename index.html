<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SluisDiagramTool</title>
  <link href="css/app.css" type="text/css" rel="stylesheet" >
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">

</head>
<body>

  <ul id="debug">
    <li>
      <label id="label-chamber-id">Kolk-id:</label>
      <input name="chamberID" id="chamber-id">
    </li>

    <li>
      <label id="label-filename">Filename:</label>
      <input name="filename" id="filename">
    </li>

    <li>
      <label id="label-config-string">Configuration string:</label>
      <input name="configString" id="config-string">
      <button id="set-config-string">Teken</button>
      <button id="get-config-string">Opvragen</button>
    </li>

    <li>
      <button id="download">Download</button>
    </li>


  </ul>

  <ul id="toolbar"></ul>

  <ul id="diagram"></ul>


<!--Javascript YAML-library for reading in the element-configuration: https://github.com/nodeca/js-yaml-->
<script src="vendor/js-yaml.min.js"></script>

<!-- jQuery Minified: -->
<script src="vendor/jquery-3.2.1.min.js"></script>

  <!--Parts of jQuery UI for drag/drop behaviour-->
<script src="vendor/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>

<!--Application script-->
<script src="js/app.js"></script>

<!-- Implementation of application-script -->
<script>
  libConfig.setChamberID("31415");
  libConfig.loadAssetsAndCatalogue();
  libConfig.setToolbar('#toolbar');
  libConfig.setDiagram('#diagram');
  libConfig.setConfigString("(12345 N ABC)<    <(Saaie sluis, hoor!)"); // implicit drawDiagram

  $("#download").on("click", function () {
    var strFileName = $("#filename").val();

    if (strFileName == "") {
      strFileName = $("#chamber-id").val();
    }

    if (strFileName == "") {
      strFileName = uniqueStringFromTime();
    }

    libConfig.composeSVG(strFileName);
  });

  $("#get-config-string").on("click", function () {
    str = libConfig.getConfigString();

    $("#config-string")
            .val(str)
            .attr('style', "width: " + (str.length) * 0.6 + "em");
  });

  $("#set-config-string").on("click", function () {
    libConfig.setConfigString($("#config-string").val());
    libConfig.drawDiagram();
  });

  $("#chamber-id").on("change", function () {
    libConfig.setChamberID($(this).val());
  });


  // Helper function to provide a unique string based on the time stamp
  function uniqueStringFromTime() {
    var d = new Date();
    var n = d.getTime();
    return n.toString(36); // Number to 36-base string.
  }
</script>

</body>
</html>